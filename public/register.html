<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim of World - KayÄ±t Ol</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0d0d0d;
            --bg-card: #161616;
            --accent-cyan: #00e5ff;
            --accent-green: #2ecc71;
            --accent-red: #e74c3c;
            --text-white: #ffffff;
            --text-gray: #a0a0a0;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: #000;
            font-family: 'Rajdhani', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text-white);
            background-image: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url('https://images.unsplash.com/photo-1451187580459-43490279c0fa?q=80&w=2072');
            background-size: cover;
            background-position: center;
        }

        .auth-container {
            width: 100%;
            max-width: 400px;
            background-color: rgba(22, 22, 22, 0.95);
            padding: 40px;
            border-radius: 10px;
            border: 1px solid #333;
            box-shadow: 0 0 30px rgba(0, 229, 255, 0.1);
            text-align: center;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--text-white);
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .logo span { color: var(--accent-cyan); }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 5px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-cyan);
        }

        .phone-group {
            display: flex;
            gap: 10px;
        }
        .phone-group select {
            width: 120px;
            padding: 12px;
            background: #0a0a0a;
            border: 1px solid #333;
            border-radius: 5px;
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
        }
        .phone-group input {
            flex: 1;
        }
        
        .hint-text {
            font-size: 0.75rem;
            color: #666;
            margin-top: 4px;
        }

        .btn-auth {
            width: 100%;
            padding: 12px;
            background: var(--accent-green);
            color: #000;
            border: none;
            border-radius: 5px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-auth:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .auth-footer {
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--text-gray);
        }

        .auth-link {
            color: var(--accent-cyan);
            text-decoration: none;
            font-weight: 600;
        }
        .auth-link:hover { text-decoration: underline; }

        .error-msg {
            color: var(--accent-red);
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: none;
        }
        .success-msg {
            color: var(--accent-green);
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: none;
        }

        .kvkk-link {
            display: inline-block;
            margin-top: 15px;
            color: var(--accent-cyan);
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: underline;
        }

        /* Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: #161616;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 10px;
            border: 1px solid var(--accent-cyan);
            padding: 30px;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #888;
        }
        .modal-close:hover { color: #fff; }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-cyan);
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-text {
            color: #ccc;
            line-height: 1.6;
            font-size: 0.9rem;
        }

        .modal-text h3 {
            color: var(--accent-cyan);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        /* Cookie Banner */
        .cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(13, 13, 13, 0.98);
            border-top: 2px solid var(--accent-cyan);
            padding: 20px;
            z-index: 10000;
            display: none;
        }

        .cookie-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            flex-wrap: wrap;
        }

        .cookie-text {
            flex: 1;
            color: #ccc;
            font-size: 0.9rem;
        }

        .cookie-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-cookie {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-accept {
            background: var(--accent-green);
            color: #000;
        }

        .btn-reject {
            background: #333;
            color: #fff;
        }

        .btn-cookie:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

    <div class="auth-container">
        <div class="logo">Sim of <span>World</span></div>
        
        <div class="error-msg" id="errorMsg">KayÄ±t baÅŸarÄ±sÄ±z!</div>
        <div class="success-msg" id="successMsg">KayÄ±t baÅŸarÄ±lÄ±! YÃ¶nlendiriliyorsunuz...</div>

        <form id="registerForm" onsubmit="handleRegister(event)">
            <div class="form-group">
                <label class="form-label">KullanÄ±cÄ± AdÄ±</label>
                <input type="text" class="form-input" id="username" required minlength="3" maxlength="20">
                <div class="hint-text">3-20 karakter arasÄ±nda olmalÄ±</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">E-posta</label>
                <input type="email" class="form-input" id="email" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Telefon NumarasÄ±</label>
                <div class="phone-group">
                    <select id="countryCode" class="form-input">
                        <option value="+90">+90 (TR)</option>
                        <option value="+1">+1 (US)</option>
                        <option value="+44">+44 (UK)</option>
                        <option value="+49">+49 (DE)</option>
                        <option value="+33">+33 (FR)</option>
                        <option value="+39">+39 (IT)</option>
                        <option value="+34">+34 (ES)</option>
                        <option value="+7">+7 (RU)</option>
                        <option value="+86">+86 (CN)</option>
                        <option value="+91">+91 (IN)</option>
                        <option value="+81">+81 (JP)</option>
                        <option value="+82">+82 (KR)</option>
                        <option value="+55">+55 (BR)</option>
                        <option value="+52">+52 (MX)</option>
                        <option value="+61">+61 (AU)</option>
                        <option value="+971">+971 (AE)</option>
                        <option value="+966">+966 (SA)</option>
                    </select>
                    <input type="tel" class="form-input" id="phone" required placeholder="5xx xxx xx xx">
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Åifre</label>
                <input type="password" class="form-input" id="password" required minlength="6">
                <div class="hint-text">En az 6 karakter, 1 bÃ¼yÃ¼k ve 1 kÃ¼Ã§Ã¼k harf iÃ§ermeli</div>
            </div>

            <button type="submit" class="btn-auth">KAYIT OL</button>
        </form>

        <div class="kvkk-link" onclick="openKVKKModal()">KVKK AydÄ±nlatma Metni</div>

        <div class="auth-footer">
            Zaten hesabÄ±n var mÄ±? <a href="login.html" class="auth-link">GiriÅŸ Yap</a>
        </div>
    </div>

    <!-- KVKK Modal -->
    <div class="modal-overlay" id="kvkkModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" onclick="closeKVKKModal()"></i>
            <div class="modal-title">KÄ°ÅÄ°SEL VERÄ°LERÄ°N KORUNMASI AYDINLATMA METNÄ°</div>
            <div class="modal-text">
                <h3>1. Veri Sorumlusu</h3>
                <p>Sim of World olarak, 6698 sayÄ±lÄ± KiÅŸisel Verilerin KorunmasÄ± Kanunu ("KVKK") uyarÄ±nca veri sorumlusu sÄ±fatÄ±yla, kiÅŸisel verilerinizi aÅŸaÄŸÄ±da aÃ§Ä±klanan kapsamda iÅŸlemekteyiz.</p>
                
                <h3>2. Ä°ÅŸlenen KiÅŸisel Veriler</h3>
                <p>KayÄ±t iÅŸlemi sÄ±rasÄ±nda toplanan veriler:</p>
                <ul>
                    <li>KullanÄ±cÄ± adÄ±</li>
                    <li>E-posta adresi</li>
                    <li>Telefon numarasÄ±</li>
                    <li>IP adresi</li>
                    <li>KayÄ±t tarihi</li>
                </ul>
                
                <h3>3. KiÅŸisel Verilerin Ä°ÅŸlenme AmacÄ±</h3>
                <p>KiÅŸisel verileriniz aÅŸaÄŸÄ±daki amaÃ§larla iÅŸlenmektedir:</p>
                <ul>
                    <li>Oyun hesabÄ±nÄ±zÄ±n oluÅŸturulmasÄ± ve yÃ¶netimi</li>
                    <li>Kimlik doÄŸrulama iÅŸlemleri</li>
                    <li>Ä°letiÅŸim faaliyetleri</li>
                    <li>GÃ¼venlik ve dolandÄ±rÄ±cÄ±lÄ±k Ã¶nleme</li>
                    <li>Yasal yÃ¼kÃ¼mlÃ¼lÃ¼klerin yerine getirilmesi</li>
                </ul>
                
                <h3>4. KiÅŸisel Verilerin AktarÄ±mÄ±</h3>
                <p>KiÅŸisel verileriniz, yukarÄ±da belirtilen amaÃ§larÄ±n gerÃ§ekleÅŸtirilmesi doÄŸrultusunda iÅŸ ortaklarÄ±mÄ±za ve yasal zorunluluklar Ã§erÃ§evesinde yetkili kamu kurum ve kuruluÅŸlarÄ±na aktarÄ±labilir.</p>
                
                <h3>5. KiÅŸisel Veri ToplamanÄ±n YÃ¶ntemi ve Hukuki Sebebi</h3>
                <p>KiÅŸisel verileriniz, elektronik ortamda kayÄ±t formlarÄ± aracÄ±lÄ±ÄŸÄ±yla toplanmaktadÄ±r. Hukuki sebebi, hizmet sunumu iÃ§in sÃ¶zleÅŸmenin kurulmasÄ± ve ifasÄ± ile yasal yÃ¼kÃ¼mlÃ¼lÃ¼klerin yerine getirilmesidir.</p>
                
                <h3>6. KiÅŸisel Veri Sahibinin HaklarÄ±</h3>
                <p>KVKK'nÄ±n 11. maddesi uyarÄ±nca, aÅŸaÄŸÄ±daki haklara sahipsiniz:</p>
                <ul>
                    <li>KiÅŸisel verilerinizin iÅŸlenip iÅŸlenmediÄŸini Ã¶ÄŸrenme</li>
                    <li>Ä°ÅŸlenmiÅŸse buna iliÅŸkin bilgi talep etme</li>
                    <li>Ä°ÅŸlenme amacÄ±nÄ± ve amacÄ±na uygun kullanÄ±lÄ±p kullanÄ±lmadÄ±ÄŸÄ±nÄ± Ã¶ÄŸrenme</li>
                    <li>Yurt iÃ§inde/yurt dÄ±ÅŸÄ±nda aktarÄ±ldÄ±ÄŸÄ± 3. kiÅŸileri bilme</li>
                    <li>Eksik veya yanlÄ±ÅŸ iÅŸlenmiÅŸse dÃ¼zeltilmesini isteme</li>
                    <li>KVKK'da Ã¶ngÃ¶rÃ¼len ÅŸartlar Ã§erÃ§evesinde silinmesini isteme</li>
                    <li>AktarÄ±ldÄ±ÄŸÄ± 3. kiÅŸilere yukarÄ±daki deÄŸiÅŸikliklerin bildirilmesini isteme</li>
                    <li>MÃ¼nhasÄ±ran otomatik sistemler ile analiz edilmesi nedeniyle aleyhinize sonuÃ§ doÄŸmasÄ±na itiraz etme</li>
                    <li>Kanuna aykÄ±rÄ± iÅŸlenmesi sebebiyle zarara uÄŸramanÄ±z halinde zararÄ±n giderilmesini talep etme</li>
                </ul>
                
                <p style="margin-top: 20px;">Bu haklarÄ±nÄ±zÄ± kullanmak iÃ§in bizimle iletiÅŸime geÃ§ebilirsiniz.</p>
            </div>
        </div>
    </div>

    <!-- Cookie Banner -->
    <div class="cookie-banner" id="cookieBanner">
        <div class="cookie-content">
            <div class="cookie-text">
                <strong>ğŸª Ã‡erez PolitikasÄ±</strong><br>
                Web sitemizde deneyiminizi geliÅŸtirmek iÃ§in Ã§erezler kullanÄ±yoruz. Ã‡erezleri kabul ederek sitemizin daha iyi Ã§alÄ±ÅŸmasÄ±na yardÄ±mcÄ± olursunuz.
            </div>
            <div class="cookie-buttons">
                <button class="btn-cookie btn-reject" onclick="rejectCookies()">Reddet</button>
                <button class="btn-cookie btn-accept" onclick="acceptCookies()">Kabul Et</button>
            </div>
        </div>
    </div>

    <script>
        // Sayfa yÃ¼klendiÄŸinde Ã§erez bannerÄ±nÄ± kontrol et
        window.addEventListener('load', () => {
            const cookieConsent = localStorage.getItem('cookieConsent');
            if (!cookieConsent) {
                document.getElementById('cookieBanner').style.display = 'block';
            }
        });

        function openKVKKModal() {
            document.getElementById('kvkkModal').style.display = 'flex';
        }

        function closeKVKKModal() {
            document.getElementById('kvkkModal').style.display = 'none';
        }

        async function acceptCookies() {
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookieBanner').style.display = 'none';
            
            // Sunucuya Ã§erez onayÄ±nÄ± gÃ¶nder
            try {
                await fetch('/api/cookie-consent', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        consent: true,
                        timestamp: new Date().toISOString()
                    })
                });
            } catch (err) {
                console.error('Cookie consent error:', err);
            }
        }

        function rejectCookies() {
            localStorage.setItem('cookieConsent', 'rejected');
            document.getElementById('cookieBanner').style.display = 'none';
        }

        async function handleRegister(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const email = document.getElementById('email').value.trim();
            const countryCode = document.getElementById('countryCode').value;
            const phone = document.getElementById('phone').value.trim();
            const password = document.getElementById('password').value;
            const errorMsg = document.getElementById('errorMsg');
            const successMsg = document.getElementById('successMsg');

            // Validasyonlar
            if (username.length < 3 || username.length > 20) {
                errorMsg.innerText = 'KullanÄ±cÄ± adÄ± 3-20 karakter arasÄ±nda olmalÄ±!';
                errorMsg.style.display = 'block';
                return;
            }

            if (password.length < 6) {
                errorMsg.innerText = 'Åifre en az 6 karakter olmalÄ±!';
                errorMsg.style.display = 'block';
                return;
            }

            // Åifrede bÃ¼yÃ¼k ve kÃ¼Ã§Ã¼k harf kontrolÃ¼
            const hasUpperCase = /[A-Z]/.test(password);
            const hasLowerCase = /[a-z]/.test(password);
            if (!hasUpperCase || !hasLowerCase) {
                errorMsg.innerText = 'Åifre en az 1 bÃ¼yÃ¼k ve 1 kÃ¼Ã§Ã¼k harf iÃ§ermeli!';
                errorMsg.style.display = 'block';
                return;
            }

            // Telefon format kontrolÃ¼ (sadece rakam)
            if (!/^\d+$/.test(phone)) {
                errorMsg.innerText = 'Telefon numarasÄ± sadece rakamlardan oluÅŸmalÄ±!';
                errorMsg.style.display = 'block';
                return;
            }

            const fullPhone = countryCode + phone;

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        username, 
                        email,
                        phone: fullPhone,
                        password 
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    successMsg.style.display = 'block';
                    errorMsg.style.display = 'none';
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1500);
                } else {
                    errorMsg.innerText = data.message || 'KayÄ±t baÅŸarÄ±sÄ±z.';
                    errorMsg.style.display = 'block';
                    successMsg.style.display = 'none';
                }
            } catch (err) {
                console.error(err);
                errorMsg.innerText = 'Sunucu hatasÄ±!';
                errorMsg.style.display = 'block';
            }
        }
    </script>
    <script src="js/loader-manager.js"></script>
</body>
</html>